<?php
 namespace app\index\controller; use app\cli\model\JobQueue as JobQueueModel; use app\cli\model\Scheduler as SchedulerModel; use app\cli\logic\Scheduler as SchedulerLogic; use think\Log; use think\Debug; class Schedulers extends Common { public function index($page = 1, $rows = DEFAULT_PAGE_ROWS) { goto DlAx1; n2hyx: return json([]); goto Tgry0; l5abi: return $this->fetch(); goto YLLKJ; DlAx1: if (!$this->request->isGet()) { goto cOIMk; } goto l5abi; flV9g: return json(["\164\157\164\x61\154" => $total, "\x72\157\x77\163" => $items]); goto Bqs86; YLLKJ: cOIMk: goto mEtm1; pzsYx: $total = SchedulerModel::where($where)->count(); goto tP6LH; Tgry0: SXJcV: goto BPCJi; tP6LH: if (!empty($total)) { goto SXJcV; } goto n2hyx; mEtm1: $where = ["\x64\x65\154\x65\164\x65\x64" => 0]; goto pzsYx; BPCJi: $items = SchedulerModel::where($where)->page($page, $rows)->order("\151\x64\x20\144\145\163\x63")->select(); goto flV9g; Bqs86: } public function edit($id = '') { goto rO0KG; WLU21: kAffp: goto AkYG0; Rwb8d: $data["\x69\144"] = intval($id); goto sx7m1; Gjd2W: RqS_0: goto pm_MK; wKooS: XIQlQ: goto p1O3X; L0PD6: return ajaxSuccess("\344\277\x9d\xe5\xad\230\346\210\x90\xe5\x8a\237"); goto oEAqC; VNapT: goto XIQlQ; goto Gjd2W; rO0KG: if (!$this->request->isGet()) { goto kAffp; } goto tUtEF; tjYAL: pWPmB: goto wKooS; AkYG0: $data = input("\x70\157\x73\x74\56"); goto Rwb8d; p1O3X: return $this->fetch('', ["\x72\x6f\x77" => $row]); goto WLU21; iVsDV: if ($row) { goto pWPmB; } goto kMuP9; tUtEF: if ($id) { goto RqS_0; } goto wS9wk; sx7m1: SchedulerLogic::I()->saveScheduler($data); goto L0PD6; pm_MK: $row = SchedulerLogic::I()->getScheduler($id); goto iVsDV; wS9wk: $row = ["\151\144" => 0, "\156\141\x6d\x65" => '', "\x64\x69\163\141\x62\x6c\145\x64" => 0, "\x6a\157\142" => '', "\151\156\x74\x65\x72\x76\141\x6c" => '', "\x64\141\x74\145\137\x74\151\155\x65\137\163\164\x61\162\164" => date("\x59\55\155\x2d\x64\40\x48\72\x69"), "\144\141\164\145\137\x74\151\x6d\x65\x5f\145\x6e\x64" => '']; goto VNapT; kMuP9: return $this->fetch("\143\x6f\x6d\x6d\157\156\57\145\162\162\157\162"); goto tjYAL; oEAqC: } public function remove($id) { try { SchedulerModel::update(["\144\145\x6c\x65\164\x65\x64" => 1], ["\151\x64" => $id]); } catch (\Exception $e) { return ajaxError($e->getMessage()); } return ajaxSuccess("\345\x88\240\351\231\xa4\xe6\210\220\xe5\x8a\237"); } public function view($id) { $row = SchedulerLogic::I()->getScheduler($id); return $this->fetch('', ["\162\157\x77" => $row]); } public function logs($page = 1, $rows = DEFAULT_PAGE_ROWS, $scheduler_id = 0) { goto taqYH; WB06p: return $this->fetch('', ["\x73\143\150\145\x64\x75\154\145\x72\x5f\x69\144" => $scheduler_id]); goto RJZTF; aKrj8: ENFYG: goto nJdPP; nJdPP: $items = JobQueueModel::where($where)->page($page, $rows)->order("\x69\144\x20\104\105\123\x43")->select(); goto SHh8y; taqYH: if (!$this->request->isGet()) { goto JT4qg; } goto WB06p; X0Mn0: $where = ["\x73\x63\x68\x65\144\x75\154\x65\162\x5f\151\144" => $scheduler_id]; goto g2Rgh; RJZTF: JT4qg: goto X0Mn0; tnqsz: return json([]); goto aKrj8; SHh8y: return json(["\164\x6f\164\x61\154" => $total, "\x72\x6f\167\163" => $items]); goto xGMHS; fS2UR: if (!empty($total)) { goto ENFYG; } goto tnqsz; g2Rgh: $total = JobQueueModel::where($where)->count(); goto fS2UR; xGMHS: } }
