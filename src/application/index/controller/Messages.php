<?php
 namespace app\index\controller; use think\Controller; use think\Log; use think\Debug; use think\Request; use app\index\Defs as IndexDefs; use app\index\logic\Messages as MessagesLogic; class Messages extends Common { public function index($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = '', $order = '') { goto dq8OZ; KBk5Y: $this->assign("\165\162\x6c\110\x72\145\x66\x73", $urlHrefs); goto k5HDp; k5HDp: return $this->fetch(); goto LqrUU; maJPh: $urlHrefs = ["\x69\x6e\144\x65\170" => url("\x69\156\x64\x65\x78\57\x4d\145\x73\x73\141\x67\145\163\57\151\x6e\x64\x65\170"), "\x63\x6f\x6e\164\145\156\x74" => url("\x69\156\144\x65\x78\x2f\115\145\163\x73\141\147\x65\x73\x2f\143\x6f\x6e\164\145\156\164")]; goto KBk5Y; dq8OZ: if (!request()->isGet()) { goto QtQu0; } goto maJPh; LqrUU: QtQu0: goto QEYkZ; Hne72: return json($messagesLogic->load($this->loginUserId, $search, $page, $rows, $sort, $order)); goto UvntG; QEYkZ: $messagesLogic = MessagesLogic::newObj(); goto Hne72; UvntG: } public function markRead($messageId) { goto qbvvn; NVOl0: $messagesLogic->markRead($messageId); goto ekElI; qbvvn: $messagesLogic = MessagesLogic::newObj(); goto NVOl0; ekElI: return ajaxSuccess("\xe6\223\x8d\xe4\275\x9c\xe6\x88\220\xe5\212\237"); goto KD1e3; KD1e3: } public function markAllRead() { goto Vu9il; cTiLM: $messagesLogic->markAllRead($this->loginUserId); goto bbKFK; bbKFK: return ajaxSuccess("\346\x93\215\344\275\x9c\xe6\210\x90\345\x8a\x9f"); goto ZYPum; Vu9il: $messagesLogic = MessagesLogic::newObj(); goto cTiLM; ZYPum: } public function markSelectedRead() { goto Z_Xhc; vT0kx: if (!empty($messageIds)) { goto T04z4; } goto RBg0O; mqWO8: $messageIds = input("\x70\157\163\164\x2e\x6d\x65\163\x73\141\147\x65\111\144\x73\x2f\141"); goto vT0kx; L5Nie: return ajaxSuccess("\346\223\215\xe4\275\234\xe6\210\220\345\212\x9f"); goto iQuW7; RBg0O: return ajaxSuccess("\346\223\x8d\344\xbd\x9c\346\x88\220\xe5\212\237"); goto u1m_B; WIu_9: $messagesLogic->markSelectedRead($messageIds); goto L5Nie; u1m_B: T04z4: goto WIu_9; Z_Xhc: $messagesLogic = MessagesLogic::newObj(); goto mqWO8; iQuW7: } public function content($messageId) { goto xSPLx; xSPLx: $messagesLogic = MessagesLogic::newObj(); goto Uu0Xj; fmcln: return $this->fetch(); goto bUb_y; Uu0Xj: $infos = $messagesLogic->getInfos($messageId); goto fuyNB; KiBYw: return $this->fetch("\x63\x6f\x6d\155\157\x6e\x2f\x65\x72\x72\x6f\162"); goto XVxgS; fuyNB: if (!empty($infos)) { goto qE6aM; } goto KiBYw; iEqKq: $this->assign("\x63\157\x6e\164\x65\x6e\x74", $infos["\x63\157\x6e\164\145\x6e\164"]); goto fmcln; XVxgS: qE6aM: goto iEqKq; bUb_y: } }
